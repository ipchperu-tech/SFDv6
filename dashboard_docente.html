<!DOCTYPE html>
<html lang="es" class="h-full bg-gray-100">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SFD - Dashboard Docente</title>
    
    <!-- Logo y Favicon -->
    <link rel="icon" href="https://ipch.net.pe/wp-content/uploads/2025/07/IPCH-VERTICAL-V1-COLOR.png" sizes="any">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Hoja de Estilos Unificada -->
    <link rel="stylesheet" href="css/style.css">
</head>
<body class="h-full loading">
  
  <!-- HEADER -->
  <header class="bg-white shadow-sm border-b border-gray-200">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <!-- Logo y T√≠tulo -->
        <div class="flex items-center">
          <img class="h-10 w-auto" src="https://ipch.net.pe/wp-content/uploads/2025/07/IPCH-VERTICAL-V1-COLOR.png" alt="Logo IPCH">
          <h1 class="ml-4 text-xl font-semibold text-gray-900">Dashboard Docente</h1>
        </div>
        
        <!-- Usuario y Logout -->
<div class="flex items-center space-x-4">
  <div class="text-right">
    <div class="text-sm font-medium text-gray-800" id="user-name-display">Cargando...</div>
    <div class="text-xs text-gray-500" id="user-email-display">Cargando...</div>
  </div>
  <button id="logout-button" class="btn btn-secondary btn-sm">
    Cerrar Sesi√≥n
  </button>
</div>
      </div>
    </div>
  </header>

<!-- MAIN CONTENT -->
<main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-32">
  
  <!-- M√âTRICAS PRINCIPALES -->
  <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
    
    <!-- Card: Promedio Global -->
    <div class="card text-center">
      <h3 class="text-sm font-medium text-gray-500 mb-2">Promedio Global</h3>
      <div class="text-4xl font-bold text-gray-900 mb-2" id="promedio-global">
        <span class="loading-text">...</span>
      </div>
      <div class="flex items-center justify-center text-yellow-500">
        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
          <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
        </svg>
        <span class="text-sm font-medium text-gray-700 ml-1">Estrellas</span>
      </div>
    </div>

    <!-- Card: Total Encuestas -->
    <div class="card text-center">
      <h3 class="text-sm font-medium text-gray-500 mb-2">Total de Encuestas</h3>
      <div class="text-4xl font-bold text-gray-900 mb-2" id="total-encuestas">
        <span class="loading-text">...</span>
      </div>
      <p class="text-sm text-gray-600">Respuestas recibidas</p>
    </div>

    <!-- Card: Aulas Activas -->
    <div class="card text-center">
      <h3 class="text-sm font-medium text-gray-500 mb-2">Aulas con Feedback</h3>
      <div class="text-4xl font-bold text-gray-900 mb-2" id="total-aulas">
        <span class="loading-text">...</span>
      </div>
      <p class="text-sm text-gray-600">Aulas evaluadas</p>
    </div>
  </div>

  <!-- ESTAD√çSTICAS POR AULA -->
  <div class="card mb-8">
    <div class="flex items-center justify-between mb-4">
      <h2 class="text-lg font-semibold text-gray-900">üìä Estad√≠sticas por Aula</h2>
      
      <!-- Filtros -->
      <div class="flex items-center gap-3">
        <select id="filtro-aula" class="text-sm rounded-md border-gray-300">
          <option value="">Todas las aulas</option>
        </select>
      </div>
    </div>
    
    <div id="aulas-table-container" class="overflow-x-auto">
      <p class="text-center text-gray-500 py-8">Cargando estad√≠sticas...</p>
    </div>
  </div>

  <!-- COMENTARIOS RECIENTES -->
  <div class="card">
    <div class="flex items-center justify-between mb-4">
      <h2 class="text-lg font-semibold text-gray-900">üí¨ Comentarios Recientes</h2>
      
      <!-- Filtros -->
      <div class="flex items-center gap-3">
        <input 
          type="date" 
          id="filtro-fecha-comentarios" 
          class="text-sm rounded-md border-gray-300"
          placeholder="Filtrar por fecha">
        <select id="filtro-aula-comentarios" class="text-sm rounded-md border-gray-300">
          <option value="">Todas las aulas</option>
        </select>
        <button id="reset-filtros-comentarios" class="btn btn-secondary btn-sm">
          Limpiar
        </button>
      </div>
    </div>
    
    <div id="comentarios-container" class="space-y-4">
    </div>
    
    <!-- Paginaci√≥n -->
    <div id="paginacion-container" class="hidden mt-6 flex items-center justify-between border-t pt-4">
      <div class="text-sm text-gray-600">
        Mostrando <span id="comentarios-inicio">1</span>-<span id="comentarios-fin">20</span> 
        de <span id="comentarios-total">0</span> comentarios
      </div>
      
      <div class="flex gap-2">
        <button id="pag-anterior" class="btn btn-secondary btn-sm" disabled>
          ‚Üê Anterior
        </button>
        <span id="pagina-actual" class="px-3 py-1 text-sm font-medium text-gray-700">
          P√°gina 1
        </span>
        <button id="pag-siguiente" class="btn btn-secondary btn-sm">
          Siguiente ‚Üí
        </button>
      </div>
    </div>
  </div>
</main>

<!-- ‚úÖ NUEVO: FOOTER STICKY CON BOTONES DE ACCI√ìN -->
<footer id="docente-footer" class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg z-40">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
    <div class="flex items-center justify-center">
      <div class="text-xs text-gray-500 mb-2 text-center">Acciones del Docente</div>
    </div>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
      <!-- Bot√≥n 1: Notificar Reemplazo -->
      <button id="btn-notificar-reemplazo" class="btn btn-primary flex items-center justify-center">
        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z" clip-rule="evenodd"/>
        </svg>
        Notificar Reemplazo
      </button>
      
      <!-- Bot√≥n 2: Notificar Reprogramaci√≥n -->
      <button id="btn-notificar-reprogramacion" class="btn btn-primary flex items-center justify-center">
        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"/>
        </svg>
        Notificar Reprogramaci√≥n
      </button>
      
      <!-- Bot√≥n 3: Registrar Reporte (condicional) -->
      <button id="btn-registrar-reporte" class="btn btn-primary flex items-center justify-center hidden">
        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
          <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"/>
          <path fill-rule="evenodd" d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"/>
        </svg>
        Registrar Reporte Mensual
      </button>
    </div>
  </div>
</footer>

<!-- ‚úÖ MODALES (se agregan antes del cierre de </body>) -->

<!-- Modal 1: Notificar Reemplazo -->
<div id="modal-reemplazo" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50">
  <div class="relative top-10 mx-auto p-5 border w-full max-w-2xl shadow-lg rounded-md bg-white">
    <div class="flex justify-between items-center mb-4">
      <h3 class="text-xl font-semibold text-gray-900">üìã Notificar Reemplazo</h3>
      <button type="button" id="close-modal-reemplazo" class="text-gray-400 hover:text-gray-600 text-2xl">&times;</button>
    </div>
    
    <form id="form-reemplazo" class="space-y-4">
      <!-- Campos auto-rellenados -->
      <div class="grid grid-cols-2 gap-4">
        <div>
          <label class="form-label">Fecha Actual</label>
          <input type="text" id="reemplazo-fecha-actual" readonly class="bg-gray-100 cursor-not-allowed">
        </div>
        <div>
          <label class="form-label">Docente</label>
          <input type="text" id="reemplazo-docente" readonly class="bg-gray-100 cursor-not-allowed">
        </div>
      </div>
      
      <!-- Campos editables -->
      <div>
        <label class="form-label">C√≥digo del Aula <span class="text-red-600">*</span></label>
        <input type="text" id="reemplazo-codigo-aula" required placeholder="Ej: CH-GRL-01">
      </div>
      
      <div class="grid grid-cols-2 gap-4">
        <div>
          <label class="form-label">Fecha de Reemplazo <span class="text-red-600">*</span></label>
          <input type="date" id="reemplazo-fecha-clase" required>
        </div>
        <div>
          <label class="form-label">Docente de Reemplazo <span class="text-red-600">*</span></label>
          <select id="reemplazo-docente-reemplazo" required>
            <option value="">-- Seleccionar --</option>
          </select>
        </div>
      </div>
      
      <div>
        <label class="form-label">¬øHa comunicado por el grupo del aula? <span class="text-red-600">*</span></label>
        <div class="flex gap-4">
          <label class="flex items-center">
            <input type="radio" name="reemplazo-comunicado" value="S√≠" required class="mr-2">
            <span>S√≠</span>
          </label>
          <label class="flex items-center">
            <input type="radio" name="reemplazo-comunicado" value="No" required class="mr-2">
            <span>No</span>
          </label>
        </div>
      </div>
      
      <div>
        <label class="form-label">Horario de su aula <span class="text-red-600">*</span></label>
        <div class="grid grid-cols-2 gap-2">
          <input type="time" id="reemplazo-horario" required>
          <select id="reemplazo-periodo" required>
            <option value="AM">AM</option>
            <option value="PM">PM</option>
          </select>
        </div>
      </div>
      
      <div>
        <label class="form-label">Raz√≥n o Motivo del Reemplazo <span class="text-red-600">*</span></label>
        <textarea id="reemplazo-motivo" rows="3" required placeholder="Describa el motivo..."></textarea>
      </div>
      
      <div class="bg-yellow-50 border-l-4 border-yellow-400 p-3">
        <p class="text-sm text-yellow-800">
          <strong>Nota:</strong> El justificante deber√° ser enviado a la coordinaci√≥n acad√©mica de manera privada.
        </p>
      </div>
      
      <p id="reemplazo-error" class="text-sm text-red-600 hidden"></p>
      
      <div class="flex justify-end gap-3 mt-6">
        <button type="button" class="btn btn-secondary" onclick="document.getElementById('modal-reemplazo').classList.add('hidden')">
          Cancelar
        </button>
        <button type="submit" id="btn-enviar-reemplazo" class="btn btn-primary">
          Enviar Notificaci√≥n
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Modal 2: Notificar Reprogramaci√≥n -->
<div id="modal-reprogramacion" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50">
  <div class="relative top-10 mx-auto p-5 border w-full max-w-2xl shadow-lg rounded-md bg-white">
    <div class="flex justify-between items-center mb-4">
      <h3 class="text-xl font-semibold text-gray-900">üîÑ Notificar Reprogramaci√≥n</h3>
      <button type="button" id="close-modal-reprogramacion" class="text-gray-400 hover:text-gray-600 text-2xl">&times;</button>
    </div>
    
    <form id="form-reprogramacion" class="space-y-4">
      <!-- Campos auto-rellenados -->
      <div class="grid grid-cols-2 gap-4">
        <div>
          <label class="form-label">Fecha Actual</label>
          <input type="text" id="reprog-fecha-actual" readonly class="bg-gray-100 cursor-not-allowed">
        </div>
        <div>
          <label class="form-label">Docente</label>
          <input type="text" id="reprog-docente" readonly class="bg-gray-100 cursor-not-allowed">
        </div>
      </div>
      
      <!-- Campos editables -->
      <div>
        <label class="form-label">C√≥digo del Aula <span class="text-red-600">*</span></label>
        <input type="text" id="reprog-codigo-aula" required placeholder="Ej: CH-GRL-01">
      </div>
      
      <div class="grid grid-cols-2 gap-4">
        <div>
          <label class="form-label">Fecha de Reprogramaci√≥n <span class="text-red-600">*</span></label>
          <input type="date" id="reprog-fecha-clase" required>
        </div>
        <div>
          <label class="form-label">N¬∞ de Sesi√≥n a Reprogramar <span class="text-red-600">*</span></label>
          <input type="number" id="reprog-numero-sesion" min="1" required placeholder="Ej: 5">
        </div>
      </div>
      
      <div>
        <label class="form-label">¬øHa comunicado por el grupo del aula? <span class="text-red-600">*</span></label>
        <div class="flex gap-4">
          <label class="flex items-center">
            <input type="radio" name="reprog-comunicado" value="S√≠" required class="mr-2">
            <span>S√≠</span>
          </label>
          <label class="flex items-center">
            <input type="radio" name="reprog-comunicado" value="No" required class="mr-2">
            <span>No</span>
          </label>
        </div>
      </div>
      
      <div>
        <label class="form-label">Horario de su aula <span class="text-red-600">*</span></label>
        <div class="grid grid-cols-2 gap-2">
          <input type="time" id="reprog-horario" required>
          <select id="reprog-periodo" required>
            <option value="AM">AM</option>
            <option value="PM">PM</option>
          </select>
        </div>
      </div>
      
      <div>
        <label class="form-label">Raz√≥n o Motivo de Reprogramaci√≥n <span class="text-red-600">*</span></label>
        <textarea id="reprog-motivo" rows="3" required placeholder="Describa el motivo..."></textarea>
      </div>
      
      <div class="bg-yellow-50 border-l-4 border-yellow-400 p-3">
        <p class="text-sm text-yellow-800">
          <strong>Nota:</strong> El justificante deber√° ser enviado a la coordinaci√≥n acad√©mica de manera privada.
        </p>
      </div>
      
      <p id="reprog-error" class="text-sm text-red-600 hidden"></p>
      
      <div class="flex justify-end gap-3 mt-6">
        <button type="button" class="btn btn-secondary" onclick="document.getElementById('modal-reprogramacion').classList.add('hidden')">
          Cancelar
        </button>
        <button type="submit" id="btn-enviar-reprog" class="btn btn-primary">
          Enviar Notificaci√≥n
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Modal 3: Registrar Reporte Mensual -->
<div id="modal-reporte" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50">
  <div class="relative top-10 mx-auto p-5 border w-full max-w-3xl shadow-lg rounded-md bg-white mb-10">
    <div class="flex justify-between items-center mb-4">
      <h3 class="text-xl font-semibold text-gray-900">üìä Registrar Reporte Mensual</h3>
      <button type="button" id="close-modal-reporte" class="text-gray-400 hover:text-gray-600 text-2xl">&times;</button>
    </div>
    
    <form id="form-reporte" class="space-y-4">
      <!-- Campos auto-rellenados -->
      <div class="grid grid-cols-2 gap-4">
        <div>
          <label class="form-label">Fecha Actual</label>
          <input type="text" id="reporte-fecha-actual" readonly class="bg-gray-100 cursor-not-allowed">
        </div>
        <div>
          <label class="form-label">Docente</label>
          <input type="text" id="reporte-docente" readonly class="bg-gray-100 cursor-not-allowed">
        </div>
      </div>
      
      <div>
        <label class="form-label">Mes a Reportar</label>
        <input type="text" id="reporte-mes" readonly class="bg-gray-100 cursor-not-allowed">
      </div>
      
      <div>
        <label class="form-label">Cantidad de Aulas <span class="text-red-600">*</span></label>
        <select id="reporte-cantidad-aulas" required>
          <option value="">-- Seleccionar --</option>
          <option value="1">1 aula</option>
          <option value="2">2 aulas</option>
          <option value="3">3 aulas</option>
          <option value="4">4 aulas</option>
          <option value="5">5 aulas</option>
          <option value="6">6 aulas</option>
          <option value="7">7 aulas</option>
          <option value="8">8 aulas</option>
          <option value="9">9 aulas</option>
          <option value="10">10 aulas</option>
        </select>
      </div>
      
      <!-- Contenedor din√°mico de aulas -->
      <div id="reporte-aulas-container" class="space-y-3">
        <!-- Se generan din√°micamente -->
      </div>
      
      <div>
        <label class="form-label">Enlace de Notas (Google Drive) <span class="text-red-600">*</span></label>
        <input type="url" id="reporte-enlace-notas" required placeholder="https://drive.google.com/...">
        <p class="text-xs text-gray-500 mt-1">El enlace debe ser de lectura p√∫blica</p>
      </div>
      
      <!-- Campos opcionales -->
      <div>
        <label class="form-label">Materiales Elaborados (Opcional)</label>
        <textarea id="reporte-materiales" rows="2" placeholder="Describa los materiales..."></textarea>
      </div>
      
      <div>
        <label class="form-label">Evaluaciones Extra (Opcional)</label>
        <textarea id="reporte-evaluaciones" rows="2" placeholder="Describa las evaluaciones..."></textarea>
      </div>
      
      <div>
        <label class="form-label">Participaci√≥n en Talleres/Conversatorios (Opcional)</label>
        <textarea id="reporte-participacion" rows="2" placeholder="Describa su participaci√≥n..."></textarea>
      </div>
      
      <!-- Reemplazos -->
      <div>
        <label class="form-label">¬øHa solicitado Reemplazos este mes? <span class="text-red-600">*</span></label>
        <div class="flex gap-4 mb-2">
          <label class="flex items-center">
            <input type="radio" name="reporte-reemplazos" value="S√≠" required class="mr-2">
            <span>S√≠</span>
          </label>
          <label class="flex items-center">
            <input type="radio" name="reporte-reemplazos" value="No" required class="mr-2">
            <span>No</span>
          </label>
        </div>
        <input type="number" id="reporte-reemplazos-cantidad" class="hidden" min="1" placeholder="¬øCu√°ntos?">
      </div>
      
      <!-- Reprogramaciones -->
      <div>
        <label class="form-label">¬øHa solicitado Reprogramaciones este mes? <span class="text-red-600">*</span></label>
        <div class="flex gap-4 mb-2">
          <label class="flex items-center">
            <input type="radio" name="reporte-reprogramaciones" value="S√≠" required class="mr-2">
            <span>S√≠</span>
          </label>
          <label class="flex items-center">
            <input type="radio" name="reporte-reprogramaciones" value="No" required class="mr-2">
            <span>No</span>
          </label>
        </div>
        <input type="number" id="reporte-reprogramaciones-cantidad" class="hidden" min="1" placeholder="¬øCu√°ntos?">
      </div>
      
      <div>
        <label class="form-label">Conclusiones del Mes <span class="text-red-600">*</span></label>
        <textarea id="reporte-conclusiones" rows="3" required placeholder="Escriba sus conclusiones..."></textarea>
      </div>
      
      <div>
        <label class="form-label">Recomendaciones o Sugerencias <span class="text-red-600">*</span></label>
        <textarea id="reporte-recomendaciones" rows="3" required placeholder="Escriba sus recomendaciones..."></textarea>
      </div>
      
      <!-- Canvas de Firma -->
      <div>
        <label class="form-label">Firme como lo hace en el DNI <span class="text-red-600">*</span></label>
        <div class="border-2 border-gray-300 rounded-lg bg-white">
          <canvas id="reporte-firma-canvas" width="600" height="150" class="cursor-crosshair"></canvas>
        </div>
        <button type="button" id="btn-limpiar-firma" class="btn btn-secondary btn-sm mt-2">
          Borrar Firma
        </button>
      </div>
      
      <p id="reporte-error" class="text-sm text-red-600 hidden"></p>
      
      <div class="flex justify-end gap-3 mt-6">
        <button type="button" class="btn btn-secondary" onclick="document.getElementById('modal-reporte').classList.add('hidden')">
          Cancelar
        </button>
        <button type="submit" id="btn-enviar-reporte" class="btn btn-primary">
          Enviar Reporte
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Signature Pad Library -->
<script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.7/dist/signature_pad.umd.min.js"></script>

  <script type="module" src="js/dashboard-docente.js"></script>
</body>
</html>